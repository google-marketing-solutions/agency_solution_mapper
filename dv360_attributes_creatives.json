{ "tasks": [
  { "dataset": {
    "description": "Create the DV360_Mapper dataset.",
    "auth": "user",
    "dataset": "DV360_Mapper"
  }},
  { "bigquery": {
    "description": "Create the Attributes_Creatives view.",
    "auth": "user",
    "from": {
      "query": "
        SELECT
          'Creative' AS Layer,
          * EXCEPT(Value) REPLACE(REPLACE(Attribute, '_', ' ') AS Attribute),
          CASE
            WHEN Attribute IN (
              'Transcodes_Dimensions_Width_Pixels',
              'Transcodes_Dimensions_Height_Pixels',
              'Transcodes_Bit_Rate_Kbps',
              'Transcodes_Frame_Rate',
              'Transcodes_Audio_Bit_Rate_Kbps',
              'Transcodes_Audio_Sample_Rate_Hz',
              'Transcodes_File_Size_Bytes'
            ) THEN SAFE_DIVIDE(Value - MIN(Value) OVER(), MAX(Value) OVER(PARTITION BY advertiserId) - MIN(Value) OVER(PARTITION BY advertiserId))
            ELSE SAFE_DIVIDE(Value, MAX(Value) OVER(PARTITION BY advertiserId))
          END AS Score
        FROM (
        SELECT
          partnerId,
          Partner,
          advertiserId,
          Advertiser,
          COUNTIF(cmPlacementId IS NOT NULL) AS Cm_Placement,
          COUNTIF(entityStatus = 'ENTITY_STATUS_UNSPECIFIED') AS Entity_Status_Unspecified,
          COUNTIF(entityStatus = 'ENTITY_STATUS_ACTIVE') AS Entity_Status_Active,
          COUNTIF(entityStatus = 'ENTITY_STATUS_DRAFT') AS Entity_Status_Draft,
          COUNTIF(entityStatus = 'ENTITY_STATUS_PAUSED') AS Entity_Status_Paused,
          COUNTIF(entityStatus = 'ENTITY_STATUS_SCHEDULED_FOR_DELETION') AS Entity_Status_Scheduled_For_Deletion,
          COUNTIF(TIMESTAMP_DIFF(CURRENT_TIMESTAMP(), TIMESTAMP(updateTime), DAY)  BETWEEN 0 AND 30) AS Update_Time_7,
          COUNTIF(TIMESTAMP_DIFF(CURRENT_TIMESTAMP(), TIMESTAMP(updateTime), DAY)  BETWEEN 0 AND 30) AS Update_Time_30,
          COUNTIF(TIMESTAMP_DIFF(CURRENT_TIMESTAMP(), TIMESTAMP(updateTime), DAY)  BETWEEN 0 AND 30) AS Update_Time_90,
          COUNTIF(TIMESTAMP_DIFF(CURRENT_TIMESTAMP(), TIMESTAMP(updateTime), DAY)  BETWEEN 0 AND 30) AS Update_Time_180,
          COUNTIF(TIMESTAMP_DIFF(CURRENT_TIMESTAMP(), TIMESTAMP(updateTime), DAY)  BETWEEN 0 AND 30) AS Update_Time_365,
          COUNTIF(TIMESTAMP_DIFF(CURRENT_TIMESTAMP(), TIMESTAMP(createTime), DAY)  BETWEEN 0 AND 30) AS Create_Time_7,
          COUNTIF(TIMESTAMP_DIFF(CURRENT_TIMESTAMP(), TIMESTAMP(createTime), DAY)  BETWEEN 0 AND 30) AS Create_Time_30,
          COUNTIF(TIMESTAMP_DIFF(CURRENT_TIMESTAMP(), TIMESTAMP(createTime), DAY)  BETWEEN 0 AND 30) AS Create_Time_90,
          COUNTIF(TIMESTAMP_DIFF(CURRENT_TIMESTAMP(), TIMESTAMP(createTime), DAY)  BETWEEN 0 AND 30) AS Create_Time_180,
          COUNTIF(TIMESTAMP_DIFF(CURRENT_TIMESTAMP(), TIMESTAMP(createTime), DAY)  BETWEEN 0 AND 30) AS Create_Time_365,
          COUNTIF(creativeType = 'CREATIVE_TYPE_UNSPECIFIED') AS Creative_Type_Unspecified,
          COUNTIF(creativeType = 'CREATIVE_TYPE_STANDARD') AS Creative_Type_Standard,
          COUNTIF(creativeType = 'CREATIVE_TYPE_EXPANDABLE') AS Creative_Type_Expandable,
          COUNTIF(creativeType = 'CREATIVE_TYPE_VIDEO') AS Creative_Type_Video,
          COUNTIF(creativeType = 'CREATIVE_TYPE_NATIVE') AS Creative_Type_Native,
          COUNTIF(creativeType = 'CREATIVE_TYPE_TEMPLATED_APP_INSTALL') AS Creative_Type_Templated_App_Install,
          COUNTIF(creativeType = 'CREATIVE_TYPE_NATIVE_SITE_SQUARE') AS Creative_Type_Native_Site_Square,
          COUNTIF(creativeType = 'CREATIVE_TYPE_TEMPLATED_APP_INSTALL_INTERSTITIAL') AS Creative_Type_Templated_App_Install_Interstitial,
          COUNTIF(creativeType = 'CREATIVE_TYPE_LIGHTBOX') AS Creative_Type_Lightbox,
          COUNTIF(creativeType = 'CREATIVE_TYPE_NATIVE_APP_INSTALL') AS Creative_Type_Native_App_Install,
          COUNTIF(creativeType = 'CREATIVE_TYPE_NATIVE_APP_INSTALL_SQUARE') AS Creative_Type_Native_App_Install_Square,
          COUNTIF(creativeType = 'CREATIVE_TYPE_AUDIO') AS Creative_Type_Audio,
          COUNTIF(creativeType = 'CREATIVE_TYPE_PUBLISHER_HOSTED') AS Creative_Type_Publisher_Hosted,
          COUNTIF(creativeType = 'CREATIVE_TYPE_NATIVE_VIDEO') AS Creative_Type_Native_Video,
          COUNTIF(creativeType = 'CREATIVE_TYPE_TEMPLATED_APP_INSTALL_VIDEO') AS Creative_Type_Templated_App_Install_Video,
          COUNTIF(hostingSource = 'HOSTING_SOURCE_UNSPECIFIED') AS Hosting_Source_Unspecified,
          COUNTIF(hostingSource = 'HOSTING_SOURCE_CM') AS Hosting_Source_Cm,
          COUNTIF(hostingSource = 'HOSTING_SOURCE_THIRD_PARTY') AS Hosting_Source_Third_Party,
          COUNTIF(hostingSource = 'HOSTING_SOURCE_HOSTED') AS Hosting_Source_Hosted,
          COUNTIF(hostingSource = 'HOSTING_SOURCE_RICH_MEDIA') AS Hosting_Source_Rich_Media,
          COUNTIF(dynamic) AS Dynamic,
          COUNT(DISTINCT dimensions.widthPixels) AS Dimensions_Width_Pixels,
          COUNT(DISTINCT dimensions.heightPixels) AS Dimensions_Height_Pixels,
          SUM(ARRAY_LENGTH(additionalDimensions)) AS Additional_Dimensions_Width_Pixels,
          SUM(ARRAY_LENGTH(additionalDimensions)) AS Additional_Dimensions_Height_Pixels,
          SUM(ARRAY_LENGTH(creativeAttributes)) AS Creative_Attributes,
          COUNTIF(reviewStatus.approvalStatus = 'APPROVAL_STATUS_UNSPECIFIED') AS Review_Status_Approval_Unspecified,
          COUNTIF(reviewStatus.approvalStatus = 'APPROVAL_STATUS_PENDING_NOT_SERVABLE') AS Review_Status_Approval_Pending_Not_Servable,
          COUNTIF(reviewStatus.approvalStatus = 'APPROVAL_STATUS_PENDING_SERVABLE') AS Review_Status_Approval_Pending_Servable,
          COUNTIF(reviewStatus.approvalStatus = 'APPROVAL_STATUS_APPROVED_SERVABLE') AS Review_Status_Approval_Approved_Servable,
          COUNTIF(reviewStatus.approvalStatus = 'APPROVAL_STATUS_REJECTED_NOT_SERVABLE') AS Review_Status_Approval_Rejected_Not_Servable,
          COUNTIF(reviewStatus.creativeAndLandingPageReviewStatus = 'REVIEW_STATUS_UNSPECIFIED') AS Review_Status_Creative_And_Landing_Page_Unspecified,
          COUNTIF(reviewStatus.creativeAndLandingPageReviewStatus = 'REVIEW_STATUS_APPROVED') AS Review_Status_Creative_And_Landing_Page_Approved,
          COUNTIF(reviewStatus.creativeAndLandingPageReviewStatus = 'REVIEW_STATUS_REJECTED') AS Review_Status_Creative_And_Landing_Page_Rejected,
          COUNTIF(reviewStatus.creativeAndLandingPageReviewStatus = 'REVIEW_STATUS_PENDING') AS Review_Status_Creative_And_Landing_Page_Pending,
          COUNTIF(reviewStatus.contentAndPolicyReviewStatus = 'REVIEW_STATUS_UNSPECIFIED') AS Review_Status_Content_And_Policy_Unspecified,
          COUNTIF(reviewStatus.contentAndPolicyReviewStatus = 'REVIEW_STATUS_APPROVED') AS Review_Status_Content_And_Policy_Approved,
          COUNTIF(reviewStatus.contentAndPolicyReviewStatus = 'REVIEW_STATUS_REJECTED') AS Review_Status_Content_And_Policy_Rejected,
          COUNTIF(reviewStatus.contentAndPolicyReviewStatus = 'REVIEW_STATUS_PENDING') AS Review_Status_Content_And_Policy_Pending,
          SUM((SELECT COUNT(DISTINCT exchange) FROM UNNEST(reviewStatus.exchangeReviewStatuses) WHERE exchange = 'EXCHANGE_UNSPECIFIED')) AS Review_Status_Exchange_Unspecified,
          SUM((SELECT COUNT(DISTINCT exchange) FROM UNNEST(reviewStatus.exchangeReviewStatuses) WHERE exchange = 'EXCHANGE_GOOGLE_AD_MANAGER')) AS Review_Status_Exchange_Google_Ad_Manager,
          SUM((SELECT COUNT(DISTINCT exchange) FROM UNNEST(reviewStatus.exchangeReviewStatuses) WHERE exchange = 'EXCHANGE_APPNEXUS')) AS Review_Status_Exchange_Appnexus,
          SUM((SELECT COUNT(DISTINCT exchange) FROM UNNEST(reviewStatus.exchangeReviewStatuses) WHERE exchange = 'EXCHANGE_BRIGHTROLL')) AS Review_Status_Exchange_Brightroll,
          SUM((SELECT COUNT(DISTINCT exchange) FROM UNNEST(reviewStatus.exchangeReviewStatuses) WHERE exchange = 'EXCHANGE_ADFORM')) AS Review_Status_Exchange_Adform,
          SUM((SELECT COUNT(DISTINCT exchange) FROM UNNEST(reviewStatus.exchangeReviewStatuses) WHERE exchange = 'EXCHANGE_ADMETA')) AS Review_Status_Exchange_Admeta,
          SUM((SELECT COUNT(DISTINCT exchange) FROM UNNEST(reviewStatus.exchangeReviewStatuses) WHERE exchange = 'EXCHANGE_ADMIXER')) AS Review_Status_Exchange_Admixer,
          SUM((SELECT COUNT(DISTINCT exchange) FROM UNNEST(reviewStatus.exchangeReviewStatuses) WHERE exchange = 'EXCHANGE_ADSMOGO')) AS Review_Status_Exchange_Adsmogo,
          SUM((SELECT COUNT(DISTINCT exchange) FROM UNNEST(reviewStatus.exchangeReviewStatuses) WHERE exchange = 'EXCHANGE_ADSWIZZ')) AS Review_Status_Exchange_Adswizz,
          SUM((SELECT COUNT(DISTINCT exchange) FROM UNNEST(reviewStatus.exchangeReviewStatuses) WHERE exchange = 'EXCHANGE_BIDSWITCH')) AS Review_Status_Exchange_Bidswitch,
          SUM((SELECT COUNT(DISTINCT exchange) FROM UNNEST(reviewStatus.exchangeReviewStatuses) WHERE exchange = 'EXCHANGE_BRIGHTROLL_DISPLAY')) AS Review_Status_Exchange_Brightroll_Display,
          SUM((SELECT COUNT(DISTINCT exchange) FROM UNNEST(reviewStatus.exchangeReviewStatuses) WHERE exchange = 'EXCHANGE_CADREON')) AS Review_Status_Exchange_Cadreon,
          SUM((SELECT COUNT(DISTINCT exchange) FROM UNNEST(reviewStatus.exchangeReviewStatuses) WHERE exchange = 'EXCHANGE_DAILYMOTION')) AS Review_Status_Exchange_Dailymotion,
          SUM((SELECT COUNT(DISTINCT exchange) FROM UNNEST(reviewStatus.exchangeReviewStatuses) WHERE exchange = 'EXCHANGE_FIVE')) AS Review_Status_Exchange_Five,
          SUM((SELECT COUNT(DISTINCT exchange) FROM UNNEST(reviewStatus.exchangeReviewStatuses) WHERE exchange = 'EXCHANGE_FLUCT')) AS Review_Status_Exchange_Fluct,
          SUM((SELECT COUNT(DISTINCT exchange) FROM UNNEST(reviewStatus.exchangeReviewStatuses) WHERE exchange = 'EXCHANGE_FREEWHEEL')) AS Review_Status_Exchange_Freewheel,
          SUM((SELECT COUNT(DISTINCT exchange) FROM UNNEST(reviewStatus.exchangeReviewStatuses) WHERE exchange = 'EXCHANGE_GENIEE')) AS Review_Status_Exchange_Geniee,
          SUM((SELECT COUNT(DISTINCT exchange) FROM UNNEST(reviewStatus.exchangeReviewStatuses) WHERE exchange = 'EXCHANGE_GUMGUM')) AS Review_Status_Exchange_Gumgum,
          SUM((SELECT COUNT(DISTINCT exchange) FROM UNNEST(reviewStatus.exchangeReviewStatuses) WHERE exchange = 'EXCHANGE_IMOBILE')) AS Review_Status_Exchange_Imobile,
          SUM((SELECT COUNT(DISTINCT exchange) FROM UNNEST(reviewStatus.exchangeReviewStatuses) WHERE exchange = 'EXCHANGE_IBILLBOARD')) AS Review_Status_Exchange_Ibillboard,
          SUM((SELECT COUNT(DISTINCT exchange) FROM UNNEST(reviewStatus.exchangeReviewStatuses) WHERE exchange = 'EXCHANGE_IMPROVE_DIGITAL')) AS Review_Status_Exchange_Improve_Digital,
          SUM((SELECT COUNT(DISTINCT exchange) FROM UNNEST(reviewStatus.exchangeReviewStatuses) WHERE exchange = 'EXCHANGE_INDEX')) AS Review_Status_Exchange_Index,
          SUM((SELECT COUNT(DISTINCT exchange) FROM UNNEST(reviewStatus.exchangeReviewStatuses) WHERE exchange = 'EXCHANGE_KARGO')) AS Review_Status_Exchange_Kargo,
          SUM((SELECT COUNT(DISTINCT exchange) FROM UNNEST(reviewStatus.exchangeReviewStatuses) WHERE exchange = 'EXCHANGE_MICROAD')) AS Review_Status_Exchange_Microad,
          SUM((SELECT COUNT(DISTINCT exchange) FROM UNNEST(reviewStatus.exchangeReviewStatuses) WHERE exchange = 'EXCHANGE_MOPUB')) AS Review_Status_Exchange_Mopub,
          SUM((SELECT COUNT(DISTINCT exchange) FROM UNNEST(reviewStatus.exchangeReviewStatuses) WHERE exchange = 'EXCHANGE_NEND')) AS Review_Status_Exchange_Nend,
          SUM((SELECT COUNT(DISTINCT exchange) FROM UNNEST(reviewStatus.exchangeReviewStatuses) WHERE exchange = 'EXCHANGE_ONE_BY_AOL_DISPLAY')) AS Review_Status_Exchange_One_By_Aol_Display,
          SUM((SELECT COUNT(DISTINCT exchange) FROM UNNEST(reviewStatus.exchangeReviewStatuses) WHERE exchange = 'EXCHANGE_ONE_BY_AOL_MOBILE')) AS Review_Status_Exchange_One_By_Aol_Mobile,
          SUM((SELECT COUNT(DISTINCT exchange) FROM UNNEST(reviewStatus.exchangeReviewStatuses) WHERE exchange = 'EXCHANGE_ONE_BY_AOL_VIDEO')) AS Review_Status_Exchange_One_By_Aol_Video,
          SUM((SELECT COUNT(DISTINCT exchange) FROM UNNEST(reviewStatus.exchangeReviewStatuses) WHERE exchange = 'EXCHANGE_OOYALA')) AS Review_Status_Exchange_Ooyala,
          SUM((SELECT COUNT(DISTINCT exchange) FROM UNNEST(reviewStatus.exchangeReviewStatuses) WHERE exchange = 'EXCHANGE_OPENX')) AS Review_Status_Exchange_Openx,
          SUM((SELECT COUNT(DISTINCT exchange) FROM UNNEST(reviewStatus.exchangeReviewStatuses) WHERE exchange = 'EXCHANGE_PERMODO')) AS Review_Status_Exchange_Permodo,
          SUM((SELECT COUNT(DISTINCT exchange) FROM UNNEST(reviewStatus.exchangeReviewStatuses) WHERE exchange = 'EXCHANGE_PLATFORMONE')) AS Review_Status_Exchange_Platformone,
          SUM((SELECT COUNT(DISTINCT exchange) FROM UNNEST(reviewStatus.exchangeReviewStatuses) WHERE exchange = 'EXCHANGE_PLATFORMID')) AS Review_Status_Exchange_Platformid,
          SUM((SELECT COUNT(DISTINCT exchange) FROM UNNEST(reviewStatus.exchangeReviewStatuses) WHERE exchange = 'EXCHANGE_PUBMATIC')) AS Review_Status_Exchange_Pubmatic,
          SUM((SELECT COUNT(DISTINCT exchange) FROM UNNEST(reviewStatus.exchangeReviewStatuses) WHERE exchange = 'EXCHANGE_PULSEPOINT')) AS Review_Status_Exchange_Pulsepoint,
          SUM((SELECT COUNT(DISTINCT exchange) FROM UNNEST(reviewStatus.exchangeReviewStatuses) WHERE exchange = 'EXCHANGE_REVENUEMAX')) AS Review_Status_Exchange_Revenuemax,
          SUM((SELECT COUNT(DISTINCT exchange) FROM UNNEST(reviewStatus.exchangeReviewStatuses) WHERE exchange = 'EXCHANGE_RUBICON')) AS Review_Status_Exchange_Rubicon,
          SUM((SELECT COUNT(DISTINCT exchange) FROM UNNEST(reviewStatus.exchangeReviewStatuses) WHERE exchange = 'EXCHANGE_SMARTCLIP')) AS Review_Status_Exchange_Smartclip,
          SUM((SELECT COUNT(DISTINCT exchange) FROM UNNEST(reviewStatus.exchangeReviewStatuses) WHERE exchange = 'EXCHANGE_SMARTRTB')) AS Review_Status_Exchange_Smartrtb,
          SUM((SELECT COUNT(DISTINCT exchange) FROM UNNEST(reviewStatus.exchangeReviewStatuses) WHERE exchange = 'EXCHANGE_SMARTSTREAMTV')) AS Review_Status_Exchange_Smartstreamtv,
          SUM((SELECT COUNT(DISTINCT exchange) FROM UNNEST(reviewStatus.exchangeReviewStatuses) WHERE exchange = 'EXCHANGE_SOVRN')) AS Review_Status_Exchange_Sovrn,
          SUM((SELECT COUNT(DISTINCT exchange) FROM UNNEST(reviewStatus.exchangeReviewStatuses) WHERE exchange = 'EXCHANGE_SPOTXCHANGE')) AS Review_Status_Exchange_Spotxchange,
          SUM((SELECT COUNT(DISTINCT exchange) FROM UNNEST(reviewStatus.exchangeReviewStatuses) WHERE exchange = 'EXCHANGE_STROER')) AS Review_Status_Exchange_Stroer,
          SUM((SELECT COUNT(DISTINCT exchange) FROM UNNEST(reviewStatus.exchangeReviewStatuses) WHERE exchange = 'EXCHANGE_TEADSTV')) AS Review_Status_Exchange_Teadstv,
          SUM((SELECT COUNT(DISTINCT exchange) FROM UNNEST(reviewStatus.exchangeReviewStatuses) WHERE exchange = 'EXCHANGE_TELARIA')) AS Review_Status_Exchange_Telaria,
          SUM((SELECT COUNT(DISTINCT exchange) FROM UNNEST(reviewStatus.exchangeReviewStatuses) WHERE exchange = 'EXCHANGE_TVN')) AS Review_Status_Exchange_Tvn,
          SUM((SELECT COUNT(DISTINCT exchange) FROM UNNEST(reviewStatus.exchangeReviewStatuses) WHERE exchange = 'EXCHANGE_UNITED')) AS Review_Status_Exchange_United,
          SUM((SELECT COUNT(DISTINCT exchange) FROM UNNEST(reviewStatus.exchangeReviewStatuses) WHERE exchange = 'EXCHANGE_YIELDLAB')) AS Review_Status_Exchange_Yieldlab,
          SUM((SELECT COUNT(DISTINCT exchange) FROM UNNEST(reviewStatus.exchangeReviewStatuses) WHERE exchange = 'EXCHANGE_YIELDMO')) AS Review_Status_Exchange_Yieldmo,
          SUM((SELECT COUNT(DISTINCT exchange) FROM UNNEST(reviewStatus.exchangeReviewStatuses) WHERE exchange = 'EXCHANGE_UNRULYX')) AS Review_Status_Exchange_Unrulyx,
          SUM((SELECT COUNT(DISTINCT exchange) FROM UNNEST(reviewStatus.exchangeReviewStatuses) WHERE exchange = 'EXCHANGE_OPEN8')) AS Review_Status_Exchange_Open8,
          SUM((SELECT COUNT(DISTINCT exchange) FROM UNNEST(reviewStatus.exchangeReviewStatuses) WHERE exchange = 'EXCHANGE_TRITON')) AS Review_Status_Exchange_Triton,
          SUM((SELECT COUNT(DISTINCT exchange) FROM UNNEST(reviewStatus.exchangeReviewStatuses) WHERE exchange = 'EXCHANGE_TRIPLELIFT')) AS Review_Status_Exchange_Triplelift,
          SUM((SELECT COUNT(DISTINCT exchange) FROM UNNEST(reviewStatus.exchangeReviewStatuses) WHERE exchange = 'EXCHANGE_TABOOLA')) AS Review_Status_Exchange_Taboola,
          SUM((SELECT COUNT(DISTINCT exchange) FROM UNNEST(reviewStatus.exchangeReviewStatuses) WHERE exchange = 'EXCHANGE_INMOBI')) AS Review_Status_Exchange_Inmobi,
          SUM((SELECT COUNT(DISTINCT exchange) FROM UNNEST(reviewStatus.exchangeReviewStatuses) WHERE exchange = 'EXCHANGE_SMAATO')) AS Review_Status_Exchange_Smaato,
          SUM((SELECT COUNT(DISTINCT exchange) FROM UNNEST(reviewStatus.exchangeReviewStatuses) WHERE exchange = 'EXCHANGE_AJA')) AS Review_Status_Exchange_Aja,
          SUM((SELECT COUNT(DISTINCT exchange) FROM UNNEST(reviewStatus.exchangeReviewStatuses) WHERE exchange = 'EXCHANGE_SUPERSHIP')) AS Review_Status_Exchange_Supership,
          SUM((SELECT COUNT(DISTINCT exchange) FROM UNNEST(reviewStatus.exchangeReviewStatuses) WHERE exchange = 'EXCHANGE_NEXSTAR_DIGITAL')) AS Review_Status_Exchange_Nexstar_Digital,
          SUM((SELECT COUNT(DISTINCT exchange) FROM UNNEST(reviewStatus.exchangeReviewStatuses) WHERE exchange = 'EXCHANGE_WAZE')) AS Review_Status_Exchange_Waze,
          SUM((SELECT COUNT(DISTINCT exchange) FROM UNNEST(reviewStatus.exchangeReviewStatuses) WHERE exchange = 'EXCHANGE_SOUNDCAST')) AS Review_Status_Exchange_Soundcast,
          SUM((SELECT COUNT(DISTINCT exchange) FROM UNNEST(reviewStatus.exchangeReviewStatuses) WHERE exchange = 'EXCHANGE_SHARETHROUGH')) AS Review_Status_Exchange_Sharethrough,
          SUM((SELECT COUNT(DISTINCT exchange) FROM UNNEST(reviewStatus.exchangeReviewStatuses) WHERE exchange = 'EXCHANGE_FYBER')) AS Review_Status_Exchange_Fyber,
          SUM((SELECT COUNT(DISTINCT exchange) FROM UNNEST(reviewStatus.exchangeReviewStatuses) WHERE exchange = 'EXCHANGE_RED_FOR_PUBLISHERS')) AS Review_Status_Exchange_Red_For_Publishers,
          SUM((SELECT COUNT(DISTINCT exchange) FROM UNNEST(reviewStatus.exchangeReviewStatuses) WHERE exchange = 'EXCHANGE_MEDIANET')) AS Review_Status_Exchange_Medianet,
          SUM((SELECT COUNT(DISTINCT exchange) FROM UNNEST(reviewStatus.exchangeReviewStatuses) WHERE exchange = 'EXCHANGE_TAPJOY')) AS Review_Status_Exchange_Tapjoy,
          SUM((SELECT COUNT(DISTINCT exchange) FROM UNNEST(reviewStatus.exchangeReviewStatuses) WHERE exchange = 'EXCHANGE_VISTAR')) AS Review_Status_Exchange_Vistar,
          SUM((SELECT COUNT(DISTINCT exchange) FROM UNNEST(reviewStatus.exchangeReviewStatuses) WHERE exchange = 'EXCHANGE_DAX')) AS Review_Status_Exchange_Dax,
          SUM((SELECT COUNT(DISTINCT exchange) FROM UNNEST(reviewStatus.exchangeReviewStatuses) WHERE exchange = 'EXCHANGE_JCD')) AS Review_Status_Exchange_Jcd,
          SUM((SELECT COUNT(DISTINCT exchange) FROM UNNEST(reviewStatus.exchangeReviewStatuses) WHERE exchange = 'EXCHANGE_PLACE_EXCHANGE')) AS Review_Status_Exchange_Place,
          SUM((SELECT COUNT(DISTINCT exchange) FROM UNNEST(reviewStatus.exchangeReviewStatuses) WHERE exchange = 'EXCHANGE_APPLOVIN')) AS Review_Status_Exchange_Applovin,
          SUM((SELECT COUNT(DISTINCT exchange) FROM UNNEST(reviewStatus.exchangeReviewStatuses) WHERE exchange = 'EXCHANGE_CONNATIX')) AS Review_Status_Exchange_Connatix,
          SUM((SELECT COUNT(DISTINCT exchange) FROM UNNEST(reviewStatus.exchangeReviewStatuses) WHERE exchange = 'EXCHANGE_RESET_DIGITAL')) AS Review_Status_Exchange_Reset_Digital,
          SUM((SELECT COUNT(DISTINCT exchange) FROM UNNEST(reviewStatus.exchangeReviewStatuses) WHERE exchange = 'EXCHANGE_HIVESTACK')) AS Review_Status_Exchange_Hivestack,
          SUM((SELECT COUNT(DISTINCT exchange) FROM UNNEST(reviewStatus.exchangeReviewStatuses) WHERE exchange = 'EXCHANGE_DRAX')) AS Review_Status_Exchange_Drax,
          SUM((SELECT COUNT(DISTINCT exchange) FROM UNNEST(reviewStatus.exchangeReviewStatuses) WHERE exchange = 'EXCHANGE_APPLOVIN_GBID')) AS Review_Status_Exchange_Applovin_Gbid,
          SUM((SELECT COUNT(DISTINCT exchange) FROM UNNEST(reviewStatus.exchangeReviewStatuses) WHERE exchange = 'EXCHANGE_FYBER_GBID')) AS Review_Status_Exchange_Fyber_Gbid,
          SUM((SELECT COUNT(DISTINCT exchange) FROM UNNEST(reviewStatus.exchangeReviewStatuses) WHERE exchange = 'EXCHANGE_UNITY_GBID')) AS Review_Status_Exchange_Unity_Gbid,
          SUM((SELECT COUNT(DISTINCT exchange) FROM UNNEST(reviewStatus.exchangeReviewStatuses) WHERE exchange = 'EXCHANGE_CHARTBOOST_GBID')) AS Review_Status_Exchange_Chartboost_Gbid,
          SUM((SELECT COUNT(DISTINCT exchange) FROM UNNEST(reviewStatus.exchangeReviewStatuses) WHERE exchange = 'EXCHANGE_ADMOST_GBID')) AS Review_Status_Exchange_Admost_Gbid,
          SUM((SELECT COUNT(DISTINCT exchange) FROM UNNEST(reviewStatus.exchangeReviewStatuses) WHERE exchange = 'EXCHANGE_TOPON_GBID')) AS Review_Status_Exchange_Topon_Gbid,
          SUM((SELECT COUNT(DISTINCT exchange) FROM UNNEST(reviewStatus.exchangeReviewStatuses) WHERE exchange = 'EXCHANGE_NETFLIX')) AS Review_Status_Exchange_Netflix,
          SUM((SELECT COUNT(DISTINCT status) FROM UNNEST(reviewStatus.exchangeReviewStatuses) WHERE status = 'REVIEW_STATUS_UNSPECIFIED')) AS Review_Status_Exchange_Status_Unspecified,
          SUM((SELECT COUNT(DISTINCT status) FROM UNNEST(reviewStatus.exchangeReviewStatuses) WHERE status = 'REVIEW_STATUS_APPROVED')) AS Review_Status_Exchange_Status_Approved,
          SUM((SELECT COUNT(DISTINCT status) FROM UNNEST(reviewStatus.exchangeReviewStatuses) WHERE status = 'REVIEW_STATUS_REJECTED')) AS Review_Status_Exchange_Status_Rejected,
          SUM((SELECT COUNT(DISTINCT status) FROM UNNEST(reviewStatus.exchangeReviewStatuses) WHERE status = 'REVIEW_STATUS_PENDING')) AS Review_Status_Exchange_Status_Pending,
          SUM(ARRAY_LENGTH(reviewStatus.publisherReviewStatuses)) AS Review_Status_Publisher_Name,
          SUM((SELECT COUNT(DISTINCT status) FROM UNNEST(reviewStatus.publisherReviewStatuses) WHERE status = 'REVIEW_STATUS_UNSPECIFIED')) AS Review_Status_Publisher_Statuses_Unspecified,
          SUM((SELECT COUNT(DISTINCT status) FROM UNNEST(reviewStatus.publisherReviewStatuses) WHERE status = 'REVIEW_STATUS_APPROVED')) AS Review_Status_Publisher_Statuses_Approved,
          SUM((SELECT COUNT(DISTINCT status) FROM UNNEST(reviewStatus.publisherReviewStatuses) WHERE status = 'REVIEW_STATUS_REJECTED')) AS Review_Status_Publisher_Statuses_Rejected,
          SUM((SELECT COUNT(DISTINCT status) FROM UNNEST(reviewStatus.publisherReviewStatuses) WHERE status = 'REVIEW_STATUS_PENDING')) AS Review_Status_Publisher_Statuses_Pending,
          SUM(ARRAY_LENGTH(assets)) AS Assets_Asset_Media,
          SUM(ARRAY_LENGTH(assets)) AS Assets_Asset_Content,
          SUM((SELECT COUNT(DISTINCT role) FROM UNNEST(assets) WHERE role = 'ASSET_ROLE_UNSPECIFIED')) AS Assets_Role_Asset_Unspecified,
          SUM((SELECT COUNT(DISTINCT role) FROM UNNEST(assets) WHERE role = 'ASSET_ROLE_MAIN')) AS Assets_Role_Asset_Main,
          SUM((SELECT COUNT(DISTINCT role) FROM UNNEST(assets) WHERE role = 'ASSET_ROLE_BACKUP')) AS Assets_Role_Asset_Backup,
          SUM((SELECT COUNT(DISTINCT role) FROM UNNEST(assets) WHERE role = 'ASSET_ROLE_POLITE_LOAD')) AS Assets_Role_Asset_Polite_Load,
          SUM((SELECT COUNT(DISTINCT role) FROM UNNEST(assets) WHERE role = 'ASSET_ROLE_HEADLINE')) AS Assets_Role_Asset_Headline,
          SUM((SELECT COUNT(DISTINCT role) FROM UNNEST(assets) WHERE role = 'ASSET_ROLE_LONG_HEADLINE')) AS Assets_Role_Asset_Long_Headline,
          SUM((SELECT COUNT(DISTINCT role) FROM UNNEST(assets) WHERE role = 'ASSET_ROLE_BODY')) AS Assets_Role_Asset_Body,
          SUM((SELECT COUNT(DISTINCT role) FROM UNNEST(assets) WHERE role = 'ASSET_ROLE_LONG_BODY')) AS Assets_Role_Asset_Long_Body,
          SUM((SELECT COUNT(DISTINCT role) FROM UNNEST(assets) WHERE role = 'ASSET_ROLE_CAPTION_URL')) AS Assets_Role_Asset_Caption_Url,
          SUM((SELECT COUNT(DISTINCT role) FROM UNNEST(assets) WHERE role = 'ASSET_ROLE_CALL_TO_ACTION')) AS Assets_Role_Asset_Call_To_Action,
          SUM((SELECT COUNT(DISTINCT role) FROM UNNEST(assets) WHERE role = 'ASSET_ROLE_ADVERTISER_NAME')) AS Assets_Role_Asset_Advertiser_Name,
          SUM((SELECT COUNT(DISTINCT role) FROM UNNEST(assets) WHERE role = 'ASSET_ROLE_PRICE')) AS Assets_Role_Asset_Price,
          SUM((SELECT COUNT(DISTINCT role) FROM UNNEST(assets) WHERE role = 'ASSET_ROLE_ANDROID_APP_ID')) AS Assets_Role_Asset_Android_App,
          SUM((SELECT COUNT(DISTINCT role) FROM UNNEST(assets) WHERE role = 'ASSET_ROLE_IOS_APP_ID')) AS Assets_Role_Asset_Ios_App,
          SUM((SELECT COUNT(DISTINCT role) FROM UNNEST(assets) WHERE role = 'ASSET_ROLE_RATING')) AS Assets_Role_Asset_Rating,
          SUM((SELECT COUNT(DISTINCT role) FROM UNNEST(assets) WHERE role = 'ASSET_ROLE_ICON')) AS Assets_Role_Asset_Icon,
          SUM((SELECT COUNT(DISTINCT role) FROM UNNEST(assets) WHERE role = 'ASSET_ROLE_COVER_IMAGE')) AS Assets_Role_Asset_Cover_Image,
          SUM((SELECT COUNT(DISTINCT type) FROM UNNEST(exitEvents) WHERE type = 'EXIT_EVENT_TYPE_UNSPECIFIED')) AS Exit_Events_Type_Event_Unspecified,
          SUM((SELECT COUNT(DISTINCT type) FROM UNNEST(exitEvents) WHERE type = 'EXIT_EVENT_TYPE_DEFAULT')) AS Exit_Events_Type_Event_Default,
          SUM((SELECT COUNT(DISTINCT type) FROM UNNEST(exitEvents) WHERE type = 'EXIT_EVENT_TYPE_BACKUP')) AS Exit_Events_Type_Event_Backup,
          SUM(ARRAY_LENGTH(exitEvents)) AS Exit_Events_Url,
          SUM(ARRAY_LENGTH(exitEvents)) AS Exit_Events_Name,
          SUM(ARRAY_LENGTH(exitEvents)) AS Exit_Events_Reporting_Name,
          SUM(ARRAY_LENGTH(timerEvents)) AS Timer_Events_Name,
          SUM(ARRAY_LENGTH(timerEvents)) AS Timer_Events_Reporting_Name,
          SUM(ARRAY_LENGTH(counterEvents)) AS Counter_Events_Name,
          SUM(ARRAY_LENGTH(counterEvents)) AS Counter_Events_Reporting_Name,
          COUNT(DISTINCT appendedTag) AS Appended_Tag,
          COUNT(DISTINCT integrationCode) AS Integration_Code,
          COUNT(DISTINCT notes) AS Notes,
          COUNTIF(iasCampaignMonitoring) AS Ias_Campaign_Monitoring,
          SUM(ARRAY_LENGTH(companionCreativeIds)) AS Companion_Creatives,
          COUNTIF(skippable) AS Skippable,
          COUNT(DISTINCT skipOffset.percentage) AS Skip_Offset_Percentage,
          COUNT(DISTINCT skipOffset.seconds) AS Skip_Offset_Seconds,
          COUNT(DISTINCT progressOffset.percentage) AS Progress_Offset_Percentage,
          COUNT(DISTINCT progressOffset.seconds) AS Progress_Offset_Seconds,
          COUNT(DISTINCT universalAdId.id) AS Universal_Ad,
          COUNTIF(universalAdId.registry = 'UNIVERSAL_AD_REGISTRY_UNSPECIFIED') AS Universal_Ad_Registry_Unspecified,
          COUNTIF(universalAdId.registry = 'UNIVERSAL_AD_REGISTRY_OTHER') AS Universal_Ad_Registry_Other,
          COUNTIF(universalAdId.registry = 'UNIVERSAL_AD_REGISTRY_AD_ID') AS Universal_Ad_Registry,
          COUNTIF(universalAdId.registry = 'UNIVERSAL_AD_REGISTRY_CLEARCAST') AS Universal_Ad_Registry_Clearcast,
          COUNTIF(universalAdId.registry = 'UNIVERSAL_AD_REGISTRY_DV360') AS Universal_Ad_Registry_Dv360,
          COUNTIF(universalAdId.registry = 'UNIVERSAL_AD_REGISTRY_CM') AS Universal_Ad_Registry_Cm,
          SUM((SELECT COUNT(DISTINCT type) FROM UNNEST(thirdPartyUrls) WHERE type = 'THIRD_PARTY_URL_TYPE_UNSPECIFIED')) AS Third_Party_Urls_Type_Url_Unspecified,
          SUM((SELECT COUNT(DISTINCT type) FROM UNNEST(thirdPartyUrls) WHERE type = 'THIRD_PARTY_URL_TYPE_IMPRESSION')) AS Third_Party_Urls_Type_Url_Impression,
          SUM((SELECT COUNT(DISTINCT type) FROM UNNEST(thirdPartyUrls) WHERE type = 'THIRD_PARTY_URL_TYPE_CLICK_TRACKING')) AS Third_Party_Urls_Type_Url_Click_Tracking,
          SUM((SELECT COUNT(DISTINCT type) FROM UNNEST(thirdPartyUrls) WHERE type = 'THIRD_PARTY_URL_TYPE_AUDIO_VIDEO_START')) AS Third_Party_Urls_Type_Url_Audio_Video_Start,
          SUM((SELECT COUNT(DISTINCT type) FROM UNNEST(thirdPartyUrls) WHERE type = 'THIRD_PARTY_URL_TYPE_AUDIO_VIDEO_FIRST_QUARTILE')) AS Third_Party_Urls_Type_Url_Audio_Video_First_Quartile,
          SUM((SELECT COUNT(DISTINCT type) FROM UNNEST(thirdPartyUrls) WHERE type = 'THIRD_PARTY_URL_TYPE_AUDIO_VIDEO_MIDPOINT')) AS Third_Party_Urls_Type_Url_Audio_Video_Midpoint,
          SUM((SELECT COUNT(DISTINCT type) FROM UNNEST(thirdPartyUrls) WHERE type = 'THIRD_PARTY_URL_TYPE_AUDIO_VIDEO_THIRD_QUARTILE')) AS Third_Party_Urls_Type_Url_Audio_Video_Quartile,
          SUM((SELECT COUNT(DISTINCT type) FROM UNNEST(thirdPartyUrls) WHERE type = 'THIRD_PARTY_URL_TYPE_AUDIO_VIDEO_COMPLETE')) AS Third_Party_Urls_Type_Url_Audio_Video_Complete,
          SUM((SELECT COUNT(DISTINCT type) FROM UNNEST(thirdPartyUrls) WHERE type = 'THIRD_PARTY_URL_TYPE_AUDIO_VIDEO_MUTE')) AS Third_Party_Urls_Type_Url_Audio_Video_Mute,
          SUM((SELECT COUNT(DISTINCT type) FROM UNNEST(thirdPartyUrls) WHERE type = 'THIRD_PARTY_URL_TYPE_AUDIO_VIDEO_PAUSE')) AS Third_Party_Urls_Type_Url_Audio_Video_Pause,
          SUM((SELECT COUNT(DISTINCT type) FROM UNNEST(thirdPartyUrls) WHERE type = 'THIRD_PARTY_URL_TYPE_AUDIO_VIDEO_REWIND')) AS Third_Party_Urls_Type_Url_Audio_Video_Rewind,
          SUM((SELECT COUNT(DISTINCT type) FROM UNNEST(thirdPartyUrls) WHERE type = 'THIRD_PARTY_URL_TYPE_AUDIO_VIDEO_FULLSCREEN')) AS Third_Party_Urls_Type_Url_Audio_Video_Fullscreen,
          SUM((SELECT COUNT(DISTINCT type) FROM UNNEST(thirdPartyUrls) WHERE type = 'THIRD_PARTY_URL_TYPE_AUDIO_VIDEO_STOP')) AS Third_Party_Urls_Type_Url_Audio_Video_Stop,
          SUM((SELECT COUNT(DISTINCT type) FROM UNNEST(thirdPartyUrls) WHERE type = 'THIRD_PARTY_URL_TYPE_AUDIO_VIDEO_CUSTOM')) AS Third_Party_Urls_Type_Url_Audio_Video_Custom,
          SUM((SELECT COUNT(DISTINCT type) FROM UNNEST(thirdPartyUrls) WHERE type = 'THIRD_PARTY_URL_TYPE_AUDIO_VIDEO_SKIP')) AS Third_Party_Urls_Type_Url_Audio_Video_Skip,
          SUM((SELECT COUNT(DISTINCT type) FROM UNNEST(thirdPartyUrls) WHERE type = 'THIRD_PARTY_URL_TYPE_AUDIO_VIDEO_PROGRESS')) AS Third_Party_Urls_Type_Url_Audio_Video_Progress,
          SUM(ARRAY_LENGTH(thirdPartyUrls)) AS Third_Party_Urls_Url,
          SUM(ARRAY_LENGTH(transcodes)) AS Transcodes,
          CAST(AVG((SELECT COUNT(DISTINCT name) FROM UNNEST(transcodes))) AS INT64) AS Transcodes_Name,
          CAST(AVG((SELECT COUNT(DISTINCT mimeType) FROM UNNEST(transcodes))) AS INT64) AS Transcodes_Mime_Type,
          CAST(AVG((SELECT MAX(dimensions.widthPixels) FROM UNNEST(transcodes))) AS INT64) AS Transcodes_Dimensions_Width_Pixels,
          CAST(AVG((SELECT MAX(dimensions.heightPixels) FROM UNNEST(transcodes))) AS INT64) AS Transcodes_Dimensions_Height_Pixels,
          CAST(AVG((SELECT MAX(CAST(bitRateKbps AS INT64)) FROM UNNEST(transcodes))) AS INT64) AS Transcodes_Bit_Rate_Kbps,
          CAST(AVG((SELECT MAX(frameRate) FROM UNNEST(transcodes))) AS INT64) AS Transcodes_Frame_Rate,
          CAST(AVG((SELECT MAX(CAST(audioBitRateKbps AS INT64)) FROM UNNEST(transcodes))) AS INT64) AS Transcodes_Audio_Bit_Rate_Kbps,
          CAST(AVG((SELECT MAX(CAST(audioSampleRateHz AS INT64)) FROM UNNEST(transcodes))) AS INT64) AS Transcodes_Audio_Sample_Rate_Hz,
          CAST(AVG((SELECT MAX(CAST(fileSizeBytes AS INT64)) FROM UNNEST(transcodes))) AS INT64) AS Transcodes_File_Size_Bytes,
          SUM(ARRAY_LENGTH(trackerUrls)) AS Tracker_Urls,
          COUNT(DISTINCT jsTrackerUrl) AS Js_Tracker_Url,
          COUNT(DISTINCT cmTrackingAd.cmPlacementId) AS Cm_Tracking_Ad_Placement,
          COUNT(DISTINCT cmTrackingAd.cmCreativeId) AS Cm_Tracking_Ad_Creative,
          COUNT(DISTINCT cmTrackingAd.cmAdId) AS Cm_Tracking_Ad,
          COUNT(DISTINCT obaIcon.resourceUrl) AS Oba_Icon_Resource_Url,
          COUNT(DISTINCT obaIcon.resourceMimeType) AS Oba_Icon_Resource_Mime_Type,
          COUNTIF(obaIcon.position = 'OBA_ICON_POSITION_UNSPECIFIED') AS Oba_Icon_Position_Unspecified,
          COUNTIF(obaIcon.position = 'OBA_ICON_POSITION_UPPER_RIGHT') AS Oba_Icon_Position_Upper_Right,
          COUNTIF(obaIcon.position = 'OBA_ICON_POSITION_UPPER_LEFT') AS Oba_Icon_Position_Upper_Left,
          COUNTIF(obaIcon.position = 'OBA_ICON_POSITION_LOWER_RIGHT') AS Oba_Icon_Position_Lower_Right,
          COUNTIF(obaIcon.position = 'OBA_ICON_POSITION_LOWER_LEFT') AS Oba_Icon_Position_Lower_Left,
          COUNT(DISTINCT obaIcon.dimensions.widthPixels) AS Oba_Icon_Dimensions_Width_Pixels,
          COUNT(DISTINCT obaIcon.dimensions.heightPixels) AS Oba_Icon_Dimensions_Height_Pixels,
          COUNT(DISTINCT obaIcon.program) AS Oba_Icon_Program,
          COUNT(DISTINCT obaIcon.landingPageUrl) AS Oba_Icon_Landing_Page_Url,
          COUNT(DISTINCT obaIcon.clickTrackingUrl) AS Oba_Icon_Click_Tracking_Url,
          COUNT(DISTINCT obaIcon.viewTrackingUrl) AS Oba_Icon_View_Tracking_Url,
          COUNT(DISTINCT thirdPartyTag) AS Third_Party_Tag,
          COUNTIF(requireMraid) AS Require_Mraid,
          COUNTIF(requireHtml5) AS Require_Html5,
          COUNTIF(requirePingForAttribution) AS Require_Ping_For_Attribution,
          COUNTIF(expandingDirection = 'EXPANDING_DIRECTION_UNSPECIFIED') AS Expanding_Direction_Unspecified,
          COUNTIF(expandingDirection = 'EXPANDING_DIRECTION_NONE') AS Expanding_Direction_None,
          COUNTIF(expandingDirection = 'EXPANDING_DIRECTION_UP') AS Expanding_Direction_Up,
          COUNTIF(expandingDirection = 'EXPANDING_DIRECTION_DOWN') AS Expanding_Direction_Down,
          COUNTIF(expandingDirection = 'EXPANDING_DIRECTION_LEFT') AS Expanding_Direction_Left,
          COUNTIF(expandingDirection = 'EXPANDING_DIRECTION_RIGHT') AS Expanding_Direction_Right,
          COUNTIF(expandingDirection = 'EXPANDING_DIRECTION_UP_AND_LEFT') AS Expanding_Direction_Up_And_Left,
          COUNTIF(expandingDirection = 'EXPANDING_DIRECTION_UP_AND_RIGHT') AS Expanding_Direction_Up_And_Right,
          COUNTIF(expandingDirection = 'EXPANDING_DIRECTION_DOWN_AND_LEFT') AS Expanding_Direction_Down_And_Left,
          COUNTIF(expandingDirection = 'EXPANDING_DIRECTION_DOWN_AND_RIGHT') AS Expanding_Direction_Down_And_Right,
          COUNTIF(expandingDirection = 'EXPANDING_DIRECTION_UP_OR_DOWN') AS Expanding_Direction_Up_Or_Down,
          COUNTIF(expandingDirection = 'EXPANDING_DIRECTION_LEFT_OR_RIGHT') AS Expanding_Direction_Left_Or_Right,
          COUNTIF(expandingDirection = 'EXPANDING_DIRECTION_ANY_DIAGONAL') AS Expanding_Direction_Any_Diagonal,
          COUNTIF(expandOnHover) AS Expand_On_Hover,
          COUNT(DISTINCT vastTagUrl) AS Vast_Tag_Url,
          COUNTIF(vpaid) AS Vpaid,
          COUNTIF(html5Video) AS Html5_Video,
          SUM(ARRAY_LENGTH(lineItemIds)) AS Line_Items,
          COUNTIF(mp3Audio) AS Mp3_Audio,
          COUNTIF(oggAudio) AS Ogg_Audio
        FROM `DV360_Mapper.DV360_Creatives`
        LEFT JOIN (SELECT partnerId, advertiserId, CONCAT(displayName, ' - ', advertiserId) AS Advertiser FROM `DV360_Mapper.DV360_Advertisers`) USING(advertiserId)
        LEFT JOIN (SELECT partnerId, CONCAT(displayName, ' - ', partnerId) AS Partner FROM `DV360_Mapper.DV360_Partners`) USING(partnerId)
        WHERE entityStatus != 'ENTITY_STATUS_ARCHIVED'
        GROUP BY 1,2,3,4
      )
      UNPIVOT(Value FOR Attribute IN (Cm_Placement, Entity_Status_Unspecified, Entity_Status_Active, Entity_Status_Draft, Entity_Status_Paused, Entity_Status_Scheduled_For_Deletion, Update_Time_7, Update_Time_30, Update_Time_90, Update_Time_180, Update_Time_365, Create_Time_7, Create_Time_30, Create_Time_90, Create_Time_180, Create_Time_365, Creative_Type_Unspecified, Creative_Type_Standard, Creative_Type_Expandable, Creative_Type_Video, Creative_Type_Native, Creative_Type_Templated_App_Install, Creative_Type_Native_Site_Square, Creative_Type_Templated_App_Install_Interstitial, Creative_Type_Lightbox, Creative_Type_Native_App_Install, Creative_Type_Native_App_Install_Square, Creative_Type_Audio, Creative_Type_Publisher_Hosted, Creative_Type_Native_Video, Creative_Type_Templated_App_Install_Video, Hosting_Source_Unspecified, Hosting_Source_Cm, Hosting_Source_Third_Party, Hosting_Source_Hosted, Hosting_Source_Rich_Media, Dynamic, Dimensions_Width_Pixels, Dimensions_Height_Pixels, Additional_Dimensions_Width_Pixels, Additional_Dimensions_Height_Pixels, Creative_Attributes, Review_Status_Approval_Unspecified, Review_Status_Approval_Pending_Not_Servable, Review_Status_Approval_Pending_Servable, Review_Status_Approval_Approved_Servable, Review_Status_Approval_Rejected_Not_Servable, Review_Status_Creative_And_Landing_Page_Unspecified, Review_Status_Creative_And_Landing_Page_Approved, Review_Status_Creative_And_Landing_Page_Rejected, Review_Status_Creative_And_Landing_Page_Pending, Review_Status_Content_And_Policy_Unspecified, Review_Status_Content_And_Policy_Approved, Review_Status_Content_And_Policy_Rejected, Review_Status_Content_And_Policy_Pending, Review_Status_Exchange_Unspecified, Review_Status_Exchange_Google_Ad_Manager, Review_Status_Exchange_Appnexus, Review_Status_Exchange_Brightroll, Review_Status_Exchange_Adform, Review_Status_Exchange_Admeta, Review_Status_Exchange_Admixer, Review_Status_Exchange_Adsmogo, Review_Status_Exchange_Adswizz, Review_Status_Exchange_Bidswitch, Review_Status_Exchange_Brightroll_Display, Review_Status_Exchange_Cadreon, Review_Status_Exchange_Dailymotion, Review_Status_Exchange_Five, Review_Status_Exchange_Fluct, Review_Status_Exchange_Freewheel, Review_Status_Exchange_Geniee, Review_Status_Exchange_Gumgum, Review_Status_Exchange_Imobile, Review_Status_Exchange_Ibillboard, Review_Status_Exchange_Improve_Digital, Review_Status_Exchange_Index, Review_Status_Exchange_Kargo, Review_Status_Exchange_Microad, Review_Status_Exchange_Mopub, Review_Status_Exchange_Nend, Review_Status_Exchange_One_By_Aol_Display, Review_Status_Exchange_One_By_Aol_Mobile, Review_Status_Exchange_One_By_Aol_Video, Review_Status_Exchange_Ooyala, Review_Status_Exchange_Openx, Review_Status_Exchange_Permodo, Review_Status_Exchange_Platformone, Review_Status_Exchange_Platformid, Review_Status_Exchange_Pubmatic, Review_Status_Exchange_Pulsepoint, Review_Status_Exchange_Revenuemax, Review_Status_Exchange_Rubicon, Review_Status_Exchange_Smartclip, Review_Status_Exchange_Smartrtb, Review_Status_Exchange_Smartstreamtv, Review_Status_Exchange_Sovrn, Review_Status_Exchange_Spotxchange, Review_Status_Exchange_Stroer, Review_Status_Exchange_Teadstv, Review_Status_Exchange_Telaria, Review_Status_Exchange_Tvn, Review_Status_Exchange_United, Review_Status_Exchange_Yieldlab, Review_Status_Exchange_Yieldmo, Review_Status_Exchange_Unrulyx, Review_Status_Exchange_Open8, Review_Status_Exchange_Triton, Review_Status_Exchange_Triplelift, Review_Status_Exchange_Taboola, Review_Status_Exchange_Inmobi, Review_Status_Exchange_Smaato, Review_Status_Exchange_Aja, Review_Status_Exchange_Supership, Review_Status_Exchange_Nexstar_Digital, Review_Status_Exchange_Waze, Review_Status_Exchange_Soundcast, Review_Status_Exchange_Sharethrough, Review_Status_Exchange_Fyber, Review_Status_Exchange_Red_For_Publishers, Review_Status_Exchange_Medianet, Review_Status_Exchange_Tapjoy, Review_Status_Exchange_Vistar, Review_Status_Exchange_Dax, Review_Status_Exchange_Jcd, Review_Status_Exchange_Place, Review_Status_Exchange_Applovin, Review_Status_Exchange_Connatix, Review_Status_Exchange_Reset_Digital, Review_Status_Exchange_Hivestack, Review_Status_Exchange_Drax, Review_Status_Exchange_Applovin_Gbid, Review_Status_Exchange_Fyber_Gbid, Review_Status_Exchange_Unity_Gbid, Review_Status_Exchange_Chartboost_Gbid, Review_Status_Exchange_Admost_Gbid, Review_Status_Exchange_Topon_Gbid, Review_Status_Exchange_Netflix, Review_Status_Exchange_Status_Unspecified, Review_Status_Exchange_Status_Approved, Review_Status_Exchange_Status_Rejected, Review_Status_Exchange_Status_Pending, Review_Status_Publisher_Name, Review_Status_Publisher_Statuses_Unspecified, Review_Status_Publisher_Statuses_Approved, Review_Status_Publisher_Statuses_Rejected, Review_Status_Publisher_Statuses_Pending, Assets_Asset_Media, Assets_Asset_Content, Assets_Role_Asset_Unspecified, Assets_Role_Asset_Main, Assets_Role_Asset_Backup, Assets_Role_Asset_Polite_Load, Assets_Role_Asset_Headline, Assets_Role_Asset_Long_Headline, Assets_Role_Asset_Body, Assets_Role_Asset_Long_Body, Assets_Role_Asset_Caption_Url, Assets_Role_Asset_Call_To_Action, Assets_Role_Asset_Advertiser_Name, Assets_Role_Asset_Price, Assets_Role_Asset_Android_App, Assets_Role_Asset_Ios_App, Assets_Role_Asset_Rating, Assets_Role_Asset_Icon, Assets_Role_Asset_Cover_Image, Exit_Events_Type_Event_Unspecified, Exit_Events_Type_Event_Default, Exit_Events_Type_Event_Backup, Exit_Events_Url, Exit_Events_Name, Exit_Events_Reporting_Name, Timer_Events_Name, Timer_Events_Reporting_Name, Counter_Events_Name, Counter_Events_Reporting_Name, Appended_Tag, Integration_Code, Notes, Ias_Campaign_Monitoring, Companion_Creatives, Skippable, Skip_Offset_Percentage, Skip_Offset_Seconds, Progress_Offset_Percentage, Progress_Offset_Seconds, Universal_Ad, Universal_Ad_Registry_Unspecified, Universal_Ad_Registry_Other, Universal_Ad_Registry, Universal_Ad_Registry_Clearcast, Universal_Ad_Registry_Dv360, Universal_Ad_Registry_Cm, Third_Party_Urls_Type_Url_Unspecified, Third_Party_Urls_Type_Url_Impression, Third_Party_Urls_Type_Url_Click_Tracking, Third_Party_Urls_Type_Url_Audio_Video_Start, Third_Party_Urls_Type_Url_Audio_Video_First_Quartile, Third_Party_Urls_Type_Url_Audio_Video_Midpoint, Third_Party_Urls_Type_Url_Audio_Video_Quartile, Third_Party_Urls_Type_Url_Audio_Video_Complete, Third_Party_Urls_Type_Url_Audio_Video_Mute, Third_Party_Urls_Type_Url_Audio_Video_Pause, Third_Party_Urls_Type_Url_Audio_Video_Rewind, Third_Party_Urls_Type_Url_Audio_Video_Fullscreen, Third_Party_Urls_Type_Url_Audio_Video_Stop, Third_Party_Urls_Type_Url_Audio_Video_Custom, Third_Party_Urls_Type_Url_Audio_Video_Skip, Third_Party_Urls_Type_Url_Audio_Video_Progress, Third_Party_Urls_Url, Transcodes_Name, Transcodes_Mime_Type, Transcodes, Transcodes_Dimensions_Width_Pixels, Transcodes_Dimensions_Height_Pixels, Transcodes_Bit_Rate_Kbps, Transcodes_Frame_Rate, Transcodes_Audio_Bit_Rate_Kbps, Transcodes_Audio_Sample_Rate_Hz, Transcodes_File_Size_Bytes, Tracker_Urls, Js_Tracker_Url, Cm_Tracking_Ad_Placement, Cm_Tracking_Ad_Creative, Cm_Tracking_Ad, Oba_Icon_Resource_Url, Oba_Icon_Resource_Mime_Type, Oba_Icon_Position_Unspecified, Oba_Icon_Position_Upper_Right, Oba_Icon_Position_Upper_Left, Oba_Icon_Position_Lower_Right, Oba_Icon_Position_Lower_Left, Oba_Icon_Dimensions_Width_Pixels, Oba_Icon_Dimensions_Height_Pixels, Oba_Icon_Program, Oba_Icon_Landing_Page_Url, Oba_Icon_Click_Tracking_Url, Oba_Icon_View_Tracking_Url, Third_Party_Tag, Require_Mraid, Require_Html5, Require_Ping_For_Attribution, Expanding_Direction_Unspecified, Expanding_Direction_None, Expanding_Direction_Up, Expanding_Direction_Down, Expanding_Direction_Left, Expanding_Direction_Right, Expanding_Direction_Up_And_Left, Expanding_Direction_Up_And_Right, Expanding_Direction_Down_And_Left, Expanding_Direction_Down_And_Right, Expanding_Direction_Up_Or_Down, Expanding_Direction_Left_Or_Right, Expanding_Direction_Any_Diagonal, Expand_On_Hover, Vast_Tag_Url, Vpaid, Html5_Video, Line_Items, Mp3_Audio, Ogg_Audio))"
    },
    "to": {
      "dataset": "DV360_Mapper",
      "view": "Attributes_Creatives"
    }
  }}
]}
